---
title: "Assignment_3"
author: "Cole Yagersz"
output: html_document
---

```{r}
library("caret")
library("ISLR")
library("e1071")
library("reshape2")


# Load csv
bank <- read.csv("UniversalBank.csv") 

# Keeps columns we are working with
bank <- bank[, c("Online", "CreditCard", "Personal.Loan")]

head(bank)


# Create data partition 60% Training and Remaining 40%n is Test
Index_Train <- createDataPartition(bank$Personal.Loan,p=.6,list=FALSE)
Train <- bank[Index_Train,]
Test <- bank[-Index_Train,]

# Summary of Training Set
summary(Train)


# Summary of Test Set
summary(Test)

```

Question A.
Create a pivot table for the training data with Online as a column variable, CC as a row
variable, and Loan as a secondary row variable. The values inside the table should convey
the count. In R use functions melt() and cast(), or function table(). In Python, use panda
dataframe methods melt() and pivot().

```{r}

melted <- melt(Train,id= c("Online","CreditCard","Personal.Loan"))

pivot_table <- dcast(melted,Personal.Loan+CreditCard~Online,length)

print(pivot_table)

```

Question B.
Consider the task of classifying a customer who owns a bank credit card and is actively using
online banking services. Looking at the pivot table, what is the probability that this customer will accept the loan offer? [This is the probability of loan acceptance (Loan = 1) conditional on having a bank credit card (CC = 1) and being an active user of online banking services (Online = 1)]

```{r}

print(pivot_table[4,4]/ (pivot_table[2,4]+pivot_table[4,4]))

```

Question C.
Create two separate pivot tables for the training data. One will have Loan (rows) as a
function of Online (columns) and the other will have Loan (rows) as a function of CC.

```{r}
table_loan_online <- table(Train[,c(1,3)])

table_loan_cc <- table((Train[,c(2,3)]))

print(table_loan_online)
print(table_loan_cc)

```
