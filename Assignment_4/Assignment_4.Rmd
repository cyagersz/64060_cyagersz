---
title: "Assignment_4"
author: "Cole Yagersz"
output: html_document
---

## Introduction
An equities analyst is studying the pharmaceutical industry and would like your help in exploring and understanding the financial data collected by her firm. Her main objective is to understand the structure of the pharmaceutical industry using some basic financial measures. Financial data gathered on 21 firms in the pharmaceutical industry are available in the file Pharmaceuticals.csv.

Questions:
Use cluster analysis to explore and analyze the given dataset as follows:
a. Use only the numerical variables (1 to 9) to cluster the 21 firms. Justify the various choices made in conducting the cluster analysis, such as weights for different variables, the specific clustering algorithm(s) used, the number of clusters formed, and so on.
b. Interpret the clusters with respect to the numerical variables used in forming the clusters.
c. Is there a pattern in the clusters with respect to the numerical variables (10 to 12)? (those not used in forming the clusters)
d. Provide an appropriate name for each cluster using any or all of the variables in the dataset.

```{r}

library(tidyverse) 
library(factoextra) 
library(ISLR)
library(flexclust)

# Read the dataset
pharma <- read.csv("Pharmaceuticals.csv")
head(pharma)


# Just use the numerical variables 
pharma_num <- pharma[,3:11]

# Standardize the data so all variables have equal weight
pharma_scaled <- scale(pharma_num)

# Justification:
# Scaling makes sure that large-scale variables do not dominate smaller ones 
# This gives equal weight to each variable in clustering.
```
Determine the optimal number of clusters using the Elbow Method
```{r}
# Elbow method
fviz_nbclust(pharma_scaled, kmeans, method = "wss") +
  ggtitle("Elbow Method for Choosing Optimal Number of Clusters")

```

Based on the Elbow Method plot the total within-cluster sum of squares decreases sharply up to k = 3 and levels off afterward, indicating that 3 clusters is the optimal choice.
After Getting the most optimal k with the Elbow Method I use the kmeans method to for the clustering model.

```{r}
set.seed(123)  # ensures reproducibility
km3 <- kmeans(pharma_scaled, centers = 3, nstart = 25)

print("The Number of Companies in each Cluster")
print(km3$size)

print("The Output of Centers")
print(km3$centers)

fviz_cluster(km3, data = pharma_scaled) # Visualize the output



```


Question B: Interpret the clusters with respect to the numerical variables used in forming the clusters

Cluster 1: This Cluster is made up of 4 companies that are smaller than average firms. They have lower profitability and low net profit margin but with relatively high P/E. They may likely be niche firms with lower current earnings.

Cluster 2: This Cluster is made up of 11 companies that are larger firms with good profitability.They are stable and have moderate growth. They are likely established firms and are profitable.

Cluster 3: This Cluster is made up of 6 companies that are smaller but volatile with high leverage and low efficiency.They have medium profitability and have a strong revenue growth.



Question C: Is there a pattern in the clusters with respect to the numerical variables (10 to 12)? (those not used informing the clusters)

```{r}
# Add cluster assignments
pharma_clustered <- pharma %>%
  mutate(Cluster = factor(km3$cluster))

table(pharma_clustered$Cluster, pharma_clustered$Median_Recommendation)

# Summarize Location of Headquarters
table(pharma_clustered$Cluster, pharma_clustered$Location)

# Summarize Stock Exchange
table(pharma_clustered$Cluster, pharma_clustered$Exchange)

```

Cluster 1: These firms are geographically diverse. They have Locations in Canada, Germany, UK, and the US. All of them are in NYSE.Their median recommendations are mixed, ranging from Hold to Strong Buy, reflecting varied analyst opinions likely due to their niche, smaller-scale operations.

Cluster 2: These firms are mainly in the US, which is 8 of the 11 companies but have 2 in the UK and 1 in Switzerland. All of them exchange in the NYSE. They tend to have Moderate Buy recommendations, indicating stable performance and consistent analyst confidence.

Cluster 3: These firms are concentrated in France, Ireland, and the US. Where they exchange is more varied which is in AMEX, NASDAQ, and NYSE. Their recommendations range from Hold to Moderate Buy, reflecting moderate analyst optimism amid high growth but volatility.

Conclusion: Clusters based on financial variables also show patterns in Median Recommendation, firm location, and stock exchange. This suggests that financial performance, geography, and market listing are related, giving further insight into the structure of the pharmaceutical industry.


Question D: Provide an appropriate name for each cluster using any or all of the variables in the dataset

Cluster 1: Niche, Low-Growth Firms

Cluster 2: Established, Profitable Firms

Cluster 3: High-Growth, Volatile Firms


